<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tabsigne3 &mdash; documentation TableauSigne 0.9.3</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="documentation TableauSigne 0.9.3" href="../index.html" />
    <link rel="up" title="Code du module" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li><a href="../index.html">documentation TableauSigne 0.9.3</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Code du module</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Code source de tabsigne3</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python3</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="c"># Copyright (C) 2013 Boris MAURICETTE</span>
<span class="c"># </span>
<span class="c"># This program is free software; you can redistribute it and/or modify</span>
<span class="c"># it under the terms of the GNU General Public License as published by</span>
<span class="c"># the Free Software Foundation; (GNU GPL v3)</span>
<span class="c"># </span>
<span class="c"># This program is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c"># </span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with this program; if not, write to the Free Software</span>
<span class="c"># Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>


<span class="n">__doc__</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">Classe de création de tableau de signe à l&#39;aide de sympy et lxml.</span>
<span class="s">Elle génère au choix la sortie latex ou un tableau xml à lancer dans pst+.</span>

<span class="s">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="kn">as</span> <span class="nn">regexp</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="n">version</span> <span class="o">=</span> <span class="s">&#39;0.9.3&#39;</span>

<div class="viewcode-block" id="TableauSigne"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauSigne">[docs]</a><span class="k">class</span> <span class="nc">TableauSigne</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classe de creation du tableau de signe.</span>
<span class="sd">    Les bornes par défaut sont \pm oo réglable avec le paramètre bornes.</span>

<span class="sd">    :param string expr: expression à étudier, sous forme d&#39;un produit ou quotient; avec la syntaxe sympy.</span>
<span class="sd">    :param list bornes: liste à deux éléments pour les bornes. [-oo, oo] par défaut</span>

<span class="sd">    exemple::</span>

<span class="sd">        &gt;&gt;&gt; a = TableauSigne(&#39;-1*(3*x+2)*(-5*x +4)&#39;)</span>
<span class="sd">        &gt;&gt;&gt; b = TableauSigne(&#39;(3*x+2)**3 /(2*x - 5)**2 *(5*x+1) * -8&#39;)</span>
<span class="sd">        &gt;&gt;&gt; b.export_pst(nom=&quot;SuperTest&quot;, simplif=False, ext=&#39;pag&#39;)</span>
<span class="sd">        &gt;&gt;&gt; c = TableauSigne(&#39;(3*x+2)**3 /(2*x - 5)**2 *(5*x+1) * -8&#39;, bornes=[-1, 1])</span>
<span class="sd">        &gt;&gt;&gt; d = TableauSigne(&#39;(-4*x+4)/(-2*x+3)&#39;, bornes=[0, sympify(&#39;3/2&#39;)])</span>
<span class="sd">        &gt;&gt;&gt; e = TableauSigne(&#39;x*(2-3*x)&#39;) # bug sur x factor corrigé.</span>
<span class="sd">        &gt;&gt;&gt; f = TableauSigne(&#39;3*x+1&#39;) # expression du 1er degré prise en compte</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">bornes</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expr</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span> <span class="o">=</span> <span class="n">bornes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">is_Mul</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">args</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fact_cst</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">is_Number</span><span class="p">]</span>
            <span class="c">## facteur x seul, non traité ailleurs. en principe 1 seul résultat possible.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fact_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">]</span>
            <span class="c">## facteurs puissance &gt;=2 -&gt; racines</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pow_plus</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="k">if</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">and</span> <span class="n">u</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)]</span>
            <span class="c">## facteurs simples -&gt;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pow_simple</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">is_Add</span><span class="p">]</span>
            <span class="c">## tous les facteurs positifs rammenés à puissance 1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pow_positif</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pow_plus</span><span class="p">]</span> <span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pow_simple</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fact_x</span><span class="p">)</span>
            <span class="c">## facteurs puissance négative -&gt; vi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pow_moins</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="k">if</span> <span class="n">u</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">and</span> <span class="n">u</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="o">.</span><span class="n">is_Add</span> <span class="ow">and</span> <span class="p">(</span><span class="n">degree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span> 
            <span class="c"># cas d&#39;un seul facteur de degré 1:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pow_positif</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">expr</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pow_moins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">racines</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">concat</span><span class="p">,</span>
                                  <span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pow_positif</span><span class="p">)])</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">racines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">concat</span><span class="p">,</span>
                             <span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pow_moins</span><span class="p">)])</span> <span class="c"># valeurs interdites</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_tab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arbrepst</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_arbrepst</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Création de l&#39;arbre xml et de l&#39;arbre simplifié selon le format de PST+;</span>
<span class="sd">        stockés dans self.xml, self.xmlsimplif</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;Tableau&quot;</span><span class="p">)</span>
        <span class="n">root_simplif</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s">&quot;Tableau&quot;</span><span class="p">)</span>
        <span class="n">ligne</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&quot;Lignes&quot;</span><span class="p">)</span>
        <span class="c">#ligne.text = str(len(self.facteurs)+2)</span>
        <span class="n">ligne</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">))</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&quot;Colonnes&quot;</span><span class="p">)</span>
        <span class="c">#col.text = str(2*len(self.racines)+2*len(self.vi)+4)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;Milieu&quot;</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;Bas&quot;</span><span class="p">,</span> <span class="s">&quot;Milieu&quot;</span><span class="p">,</span> <span class="s">&quot;Haut&quot;</span><span class="p">]:</span>
                <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span>\
                    <span class="n">regexp</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\$&#39;</span><span class="p">,</span>
                               <span class="s">r&#39;&#39;</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">_list2pststring</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">e</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xml</span> <span class="o">=</span> <span class="n">root</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;Bas&quot;</span><span class="p">,</span> <span class="s">&quot;Milieu&quot;</span><span class="p">,</span> <span class="s">&quot;Haut&quot;</span><span class="p">]:</span>
                <span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root_simplif</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span>\
                    <span class="n">regexp</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\$&#39;</span><span class="p">,</span>
                               <span class="s">r&#39;&#39;</span><span class="p">,</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">_list2pststring</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">e</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xmlsimplif</span> <span class="o">=</span> <span class="n">root_simplif</span>

    <span class="k">def</span> <span class="nf">_list2pststring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="c"># disparition du + dans le cas de latex(+oo)</span>
        <span class="k">return</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;#&quot;</span><span class="o">+</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">v</span><span class="o">!=</span><span class="n">oo</span><span class="p">)</span> <span class="k">else</span> <span class="s">&#39;+</span><span class="se">\\</span><span class="s">infty&#39;</span><span class="p">),</span> <span class="n">l</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_fill_ligne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tete</span><span class="p">,</span> <span class="n">facteur</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Construction de la ligne des signes concernant facteur</span>
<span class="sd">        relativement à la ligne tete.</span>

<span class="sd">        tete contient la ligne d&#39;entete du tableau.</span>
<span class="sd">        facteur est l&#39;expression dont on veut étudier le signe.</span>

<span class="sd">        On renvoie un dictionnaire avec les clés Haut Milieu Bas pour faciliter</span>
<span class="sd">        la traduction dans pst+.</span>

<span class="sd">        Le remplissage des signes est traditionnel: observer le coef dir et</span>
<span class="sd">        remplir en conséquence.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tete</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Haut&quot;</span><span class="p">:</span> <span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">],</span> <span class="s">&quot;Milieu&quot;</span><span class="p">:</span> <span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">],</span>\
                   <span class="s">&quot;Bas&quot;</span><span class="p">:</span><span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">]}</span>
        <span class="n">signe</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;-&quot;</span><span class="p">}</span>
        <span class="c">#grid = filter(lambda u: not (u in [&quot;vide&quot;, &quot;x&quot;, -oo, oo]+self.bornes), tete)</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">racines</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">vi</span> \
                      <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="c"># barres de positions</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">tete</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Haut&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="s">&quot;|&quot;</span>
            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="s">&quot;|&quot;</span>
            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Bas&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span><span class="s">&quot;|&quot;</span>
        <span class="c"># titre de la ligne</span>
        <span class="k">if</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex</span><span class="p">(</span> <span class="n">Pow</span><span class="p">(</span><span class="n">facteur</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">abs</span><span class="p">(</span><span class="n">facteur</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">latex</span><span class="p">(</span><span class="n">facteur</span><span class="p">)</span>

        <span class="c">#cas d&#39;une constante</span>
        <span class="k">if</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Number</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sign</span><span class="p">(</span><span class="n">facteur</span><span class="p">))]</span>
        <span class="c">#Autres: puissances paires</span>
        <span class="k">elif</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Pow</span> <span class="ow">and</span> <span class="n">facteur</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">facteur</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># solve renvoie une liste (peut-être vide)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">i0</span> <span class="o">=</span> <span class="n">tete</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c"># position de la racine r du facteur</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">))</span>
                <span class="n">tmp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c">#Autres à améliorer suivant puissance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Pow</span><span class="p">:</span>
                <span class="n">f</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">facteur</span><span class="o">.</span><span class="n">args</span>
            <span class="k">elif</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Add</span><span class="p">:</span>
                <span class="n">f</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">facteur</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">facteur</span><span class="o">.</span><span class="n">is_Symbol</span><span class="p">:</span>
                <span class="n">f</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">facteur</span><span class="p">,</span> <span class="mi">1</span>
            <span class="c"># position du zéro</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># solve renvoie une liste (peut-être vide)</span>
            <span class="c"># signe coeff dir</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">i0</span> <span class="o">=</span> <span class="n">tete</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c"># position de la racine r du facteur</span>
                <span class="c"># out[&quot;Bas&quot;][i0] = &quot;|&quot; déjà fait à l&#39;initialisation</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c"># out[&quot;Haut&quot;][i0] = &quot;|&quot;</span>
                <span class="c"># remplissage signe</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                        <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                        <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;vide&quot;</span><span class="p">:</span>
                            <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">_fill_last_ligne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tete</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Création de la dernière ligne du tableau par la règle des signes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">signe</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;+&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="s">&quot;-&quot;</span><span class="p">}</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tete</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;Haut&quot;</span><span class="p">:</span> <span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">],</span> <span class="s">&quot;Milieu&quot;</span><span class="p">:</span> <span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">],</span>\
                   <span class="s">&quot;Bas&quot;</span><span class="p">:</span><span class="n">l</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">]}</span>        
        <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">text{signe de }&quot;</span><span class="o">+</span><span class="n">nom</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;vide&quot;</span><span class="p">:</span>
                <span class="c">#récupérer les signes sauf 1ere ligne</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signe</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">tmp</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;-&quot;</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">))]</span>
            <span class="k">elif</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">racines</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Haut&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Bas&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span>
            <span class="k">elif</span> <span class="n">tete</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vi</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;||&quot;</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Haut&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;||&quot;</span>
                <span class="n">out</span><span class="p">[</span><span class="s">&quot;Bas&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;||&quot;</span>
        <span class="k">return</span> <span class="n">out</span>
            
    <span class="k">def</span> <span class="nf">_create_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Création du tableau de signe disponible dans self.tab et </span>
<span class="sd">        du tableau de signe simplifié disponible dans self.tabsimplif</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#values = self.racines+self.vi + 2eme borne</span>
        <span class="c"># c&#39;est plus pratique pour insérer les vides</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">racines</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">vi</span> \
                      <span class="k">if</span> <span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r</span><span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span> \
                      <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">tete</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bornes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="nb">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">concat</span><span class="p">,</span> \
                                    <span class="p">[[</span><span class="s">&quot;vide&quot;</span><span class="p">,</span><span class="n">u</span><span class="p">]</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&quot;Haut&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tete</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">],</span> <span class="s">&quot;Milieu&quot;</span><span class="p">:</span> <span class="n">tete</span><span class="p">,</span> <span class="s">&quot;Bas&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tete</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="s">&quot;vide&quot;</span><span class="p">]}]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facteurs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill_ligne</span><span class="p">(</span><span class="n">tete</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fill_last_ligne</span><span class="p">(</span><span class="n">tete</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabsimplif</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>


<div class="viewcode-block" id="TableauSigne.tab2latex"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauSigne.tab2latex">[docs]</a>    <span class="k">def</span> <span class="nf">tab2latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplif</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sortie latex du tableau de signe. Il utilise le fichier tabvar.tex comme </span>
<span class="sd">        suggéré par pstplus.</span>

<span class="sd">        :param boolean simplif: utiliser le tableau simplifié, par défaut False.</span>

<span class="sd">        exemple::</span>

<span class="sd">            &gt;&gt;&gt; a = TableauSigne(&#39;-1*(3*x+2)*(-5*x +4)&#39;)</span>
<span class="sd">            &gt;&gt;&gt; print(a.tab2latex())</span>
<span class="sd">            $$\\tabvar{%</span>
<span class="sd">            \\tx{x} &amp; \\tx{-\\infty} &amp;  &amp; \\tx{- \\frac{2}{3}} &amp;  &amp; \\tx{\\frac{4}{5}} &amp;  &amp; \\tx{+\\infty}\\cr</span>
<span class="sd">            \\tx{- 3 x -2} &amp;  &amp; \\tx{+} &amp; \\txt{0} &amp; \\tx{-} &amp; \\tx{|} &amp; \\tx{-} &amp; \\cr</span>
<span class="sd">            \\tx{- 5 x + 4} &amp;  &amp; \\tx{+} &amp; \\tx{|} &amp; \\tx{+} &amp; \\txt{0} &amp; \\tx{-} &amp; \\cr</span>
<span class="sd">            \\tx{\\text{signe de }f} &amp;  &amp; \\tx{+} &amp; \\txt{0} &amp; \\tx{-} &amp; \\txt{0} &amp; \\tx{+} &amp; \\cr}$$</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># choix du tableau</span>
        <span class="k">if</span> <span class="n">simplif</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tabsimplif</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab</span>
        <span class="c"># appliquer plusieurs substitution sur les éléments d&#39;une ligne</span>
        <span class="n">trad</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;+&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tx{+}&#39;</span><span class="p">,</span> \
                     <span class="s">&#39;-&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tx{-}&#39;</span><span class="p">,</span>\
                     <span class="s">&#39;|&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tx{|}&#39;</span><span class="p">,</span>\
                     <span class="s">&#39;||&#39;</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">dbt&#39;</span><span class="p">,</span>\
                     <span class="mi">0</span><span class="p">:</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">txt{0}&#39;</span><span class="p">,</span>\
                    <span class="s">&#39;vide&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">}</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s">&quot;$$</span><span class="se">\\</span><span class="s">tabvar{%&quot;</span>
        <span class="c">#traitement à part pour la 1ere ligne</span>
        <span class="n">out</span> <span class="o">+=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">tx{&quot;</span><span class="o">+</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">!=</span> <span class="n">oo</span> <span class="k">else</span> <span class="s">&#39;+</span><span class="se">\\</span><span class="s">infty&#39;</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;}&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;Milieu&quot;</span><span class="p">]]</span>
        <span class="c"># enlever les &#39;vide&#39;</span>
        <span class="n">L2</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">tx{vide}&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s">&#39;&#39;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">:</span>  <span class="n">u</span> <span class="o">+</span> <span class="s">&quot; &amp; &quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="p">,</span> <span class="n">L2</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="s">&quot;\cr&quot;</span>

        <span class="c">#autres lignes</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">out</span> <span class="o">+=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">tx{&quot;</span><span class="o">+</span><span class="n">l</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s">&quot;}&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">trad</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">[</span><span class="s">&quot;Milieu&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">:</span>  <span class="n">u</span> <span class="o">+</span> <span class="s">&quot; &amp; &quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="p">,</span> <span class="n">L</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s">&quot;\cr&quot;</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="s">&quot;}$$&quot;</span>
        <span class="k">return</span> <span class="n">out</span>

</div>
    <span class="k">def</span> <span class="nf">_create_latex_intervalle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">choix</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">take</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;renvoie l&#39;intervalle au format latex</span>
<span class="sd">        choix est dans la liste [&#39;++&#39; , &#39;+0&#39;, &#39;--&#39;, &#39;-0&#39;]</span>
<span class="sd">        L est une liste de taille 2</span>
<span class="sd">        take est la liste des || ou 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="n">oo</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">left] -</span><span class="se">\\</span><span class="s">infty;&#39;</span>
        <span class="k">elif</span> <span class="n">take</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;||&quot;</span> <span class="ow">or</span> <span class="n">choix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">left] &#39;</span><span class="o">+</span><span class="n">latex</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;;&#39;</span><span class="c">#ne pas prendre la borne si stt+ ou-</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\\</span><span class="s">left[ &#39;</span><span class="o">+</span><span class="n">latex</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&#39;;&#39;</span>
        <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">+</span><span class="n">oo</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="s">&#39;+</span><span class="se">\\</span><span class="s">infty </span><span class="se">\\</span><span class="s">right[&#39;</span>
        <span class="k">elif</span> <span class="n">take</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;||&quot;</span>  <span class="ow">or</span> <span class="n">choix</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="s">&#39;-&#39;</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="n">latex</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">right[&#39;</span> <span class="c"># ne pas prendre la borne</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">+=</span> <span class="n">latex</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">right]&#39;</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">_get_pm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signe</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;Milieu&#39;</span><span class="p">]</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="n">signe</span><span class="p">]</span>
        <span class="n">datas</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;Milieu&#39;</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">tab</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;Milieu&#39;</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">datas</span>

<div class="viewcode-block" id="TableauSigne.get_solutions"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauSigne.get_solutions">[docs]</a>    <span class="k">def</span> <span class="nf">get_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;renvoie les solutions d&#39;une inéquation au format latex</span>
<span class="sd">        choix est dans [&#39;++&#39;, &#39;+0&#39;, &#39;-\-&#39;, &#39;-0&#39;] pour signifier strictiment positif ou pas</span>

<span class="sd">        :param string choix: nature de l&#39;inéquation [&#39;++&#39;, &#39;+0&#39;, &#39;-\-&#39;, &#39;-0&#39;]</span>

<span class="sd">        exemple::</span>

<span class="sd">            &gt;&gt;&gt; a = TableauSigne(&#39;-1*(3*x+2)*(-5*x +4)&#39;)</span>
<span class="sd">            &gt;&gt;&gt; print(a.get_solutions(&#39;+0&#39;))</span>
<span class="sd">            \left] -\infty;- \\frac{2}{3}\\right]\cup \left[ \\frac{4}{5};+\\infty \\right[</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">paires</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pm</span><span class="p">(</span><span class="n">choix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">intervs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_latex_intervalle</span><span class="p">(</span><span class="n">choix</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">paires</span><span class="p">]</span>
        <span class="n">I</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\\</span><span class="s">cup &#39;</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="n">intervs</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">intervs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">I</span>
</div>
<div class="viewcode-block" id="TableauSigne.export_pst"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauSigne.export_pst">[docs]</a>    <span class="k">def</span> <span class="nf">export_pst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="s">&quot;tableau&quot;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s">&quot;pag&quot;</span><span class="p">,</span> <span class="n">simplif</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exporter l&#39;arbre xml dans un fichier. Format pag ou pst.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#self.arbrepst()</span>
        <span class="c">#</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">nom</span><span class="o">+</span><span class="s">&quot;.&quot;</span><span class="o">+</span><span class="n">ext</span>
        <span class="n">choix</span> <span class="o">=</span><span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmlsimplif</span><span class="p">,</span> <span class="bp">False</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xml</span><span class="p">}</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">choix</span><span class="p">[</span><span class="n">simplif</span><span class="p">],</span> <span class="n">pretty_print</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="TableauSigne.export_latex"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauSigne.export_latex">[docs]</a>    <span class="k">def</span> <span class="nf">export_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="s">&quot;tableau&quot;</span><span class="p">,</span> <span class="n">simplif</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="s">&quot;tex&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Exporter la sortie latex dans un fichier. Format tex.</span>
<span class="sd">        paramètre ext pour compatibilite avec export_pst</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">nom</span><span class="o">+</span><span class="s">&quot;.tex&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab2latex</span><span class="p">(</span><span class="n">simplif</span> <span class="o">=</span> <span class="n">simplif</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c"># class TableauVariation(TableauSigne):</span>
<span class="c">#     &quot;&quot;&quot;</span>
<span class="c">#     Classe de creation d&#39;un tableau de variation. Ce n&#39;est qu&#39;une heuristique,</span>
<span class="c">#     l&#39;emplacement des flèches doit être remanié à la main dans pstplus.</span>
<span class="c">#     Les bornes par défaut sont \pm oo réglable avec le paramètre bornes.</span>
<span class="c"># </span>
<span class="c">#     :param string expr: expression à étudier; avec la syntaxe sympy.</span>
<span class="c">#     :param list bornes: liste à deux éléments pour les bornes. [-oo, oo] par défaut</span>
<span class="c"># </span>
<span class="c">#     exemple::</span>
<span class="c"># </span>
<span class="c"># </span>
<span class="c">#         &gt;&gt;&gt; a = TableauVariation(&#39;-1*(3*x+2)*(-5*x +4)&#39;)</span>
<span class="c">#         &gt;&gt;&gt; a.arbrepst()</span>
<span class="c">#         &gt;&gt;&gt; print(etree.tostring(a.xml, pretty_print=True))</span>
<span class="c">#     &quot;&quot;&quot;</span>
<span class="c"># </span>
<span class="c">#     def __init__(self, expr, *args):</span>
<span class="c">#         &quot;&quot;&quot;</span>
<span class="c">#         :type expr: string</span>
<span class="c">#         :param expr: l&#39;expression dont on veut dresser le tableau de variation</span>
<span class="c"># </span>
<span class="c">#         &quot;&quot;&quot;</span>
<span class="c">#         self.val = sympify(expr)</span>
<span class="c">#         deriv = factor(self.val.diff())</span>
<span class="c">#         TableauSigne.__init__(self, str(deriv), *args)</span>
<span class="c"># </span>
<span class="c">#     def _sens(self,s):</span>
<span class="c">#         if s == &quot;+&quot;:</span>
<span class="c">#             return &quot;/&quot;</span>
<span class="c">#         elif s == &quot;-&quot;:</span>
<span class="c">#             return &quot;\\&quot;</span>
<span class="c">#         else:</span>
<span class="c">#             return s</span>
<span class="c"># </span>
<span class="c">#     def _convert(self, s, i):</span>
<span class="c">#         &quot;&quot;&quot;indique la position et le symbole / ou \ à partir d&#39;un triplet du tableau de signe</span>
<span class="c"># </span>
<span class="c">#         &quot;&quot;&quot;</span>
<span class="c">#         try:</span>
<span class="c">#             return {&quot;+0+&quot;: (&quot;Bas&quot;, &quot;/&quot;),</span>
<span class="c">#                 &quot;+0-&quot;: (&quot;Milieu&quot;,&quot;/&quot;),</span>
<span class="c">#                 &quot;-0+&quot;: (&quot;Milieu&quot;, &quot;\\&quot;),</span>
<span class="c">#                 &quot;-0-&quot;: (&quot;Haut&quot;,&quot;\\&quot;),</span>
<span class="c">#                 &quot;0+vide&quot;: (&quot;Milieu&quot;,&quot;f(&quot;+latex(self.tab[0][&quot;Milieu&quot;][i])+&quot;)&quot;),</span>
<span class="c">#                 &quot;0-vide&quot;: (&quot;Milieu&quot;,&quot;f(&quot;+latex(self.tab[0][&quot;Milieu&quot;][i])+&quot;)&quot;),</span>
<span class="c">#                 &quot;0+0&quot;: (&quot;Milieu&quot;,&quot;f(&quot;+latex(self.tab[0][&quot;Milieu&quot;][i])+&quot;)&quot;),</span>
<span class="c">#                 &quot;0-0&quot;: (&quot;Milieu&quot;,&quot;f(&quot;+latex(self.tab[0][&quot;Milieu&quot;][i])+&quot;)&quot;),</span>
<span class="c">#                 &quot;vide+0&quot;: (&quot;Milieu&quot;, &quot;vide&quot;),</span>
<span class="c">#                 &quot;vide-0&quot;: (&quot;Milieu&quot;, &quot;vide&quot;)}[s]</span>
<span class="c">#         except KeyError:</span>
<span class="c">#             pass</span>
<span class="c"># </span>
<span class="c">#     def complete_tab(self):</span>
<span class="c">#         &quot;&quot;&quot;Création du tableau de signe de f&#39; et ajout des variations de f.</span>
<span class="c"># </span>
<span class="c">#         &quot;&quot;&quot;</span>
<span class="c">#         #self._create_tab()</span>
<span class="c">#         signe = self.tab[-1][&quot;Milieu&quot;]</span>
<span class="c">#         #var = {&quot;Haut&quot;: len(signe)*[&quot;vide&quot;], &quot;Milieu&quot;: map(self._sens, signe), &quot;Bas&quot;: len(signe)*[&quot;vide&quot;]}</span>
<span class="c">#         var = {&quot;Haut&quot;: len(signe)*[&quot;vide&quot;], &quot;Milieu&quot;: len(signe)*[&quot;vide&quot;], &quot;Bas&quot;: len(signe)*[&quot;vide&quot;]}</span>
<span class="c">#         var[&quot;Haut&quot;][0] = var[&quot;Bas&quot;][0] = &quot;&quot;</span>
<span class="c">#         var[&quot;Milieu&quot;][0] = &quot;\\text{sens de }f&quot;</span>
<span class="c">#         # TODO: valeurs extremales locales à configurer</span>
<span class="c">#         for i in range(1, len(signe)-2):</span>
<span class="c">#             position, symbole = self._convert(reduce(lambda x,y: str(x)+str(y), signe[i:i+3]), i)</span>
<span class="c">#             var[position][i] = symbole</span>
<span class="c">#         self.tab.append(var)</span>
<span class="c"># </span>
<span class="c">#     def export(self, nom=&quot;tableau&quot;):</span>
<span class="c">#         &quot;&quot;&quot;Exporter l&#39;arbre xml dans un fichier</span>
<span class="c"># </span>
<span class="c">#         &quot;&quot;&quot;</span>
<span class="c">#         self.complete_tab()</span>
<span class="c">#         self.arbrepst()</span>
<span class="c">#         #</span>
<span class="c">#         f = nom+&quot;.pst&quot;</span>
<span class="c">#         out = open(f, &#39;w&#39;)</span>
<span class="c">#         out.write( etree.tostring(self.xml, pretty_print=True) )</span>
<span class="c">#         out.close()</span>

</div></div>
<div class="viewcode-block" id="TableauFactory"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauFactory">[docs]</a><span class="k">class</span> <span class="nc">TableauFactory</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Génère une liste de tableaux de signe.</span>
<span class="sd">    On peut à l&#39;envie générer une liste de solutions d&#39;inéquations ...</span>

<span class="sd">    exemple::</span>

<span class="sd">      &gt;&gt;&gt; test = [&#39;(3*x+2)&#39;, &#39;(5*x+4)*(2*x+8)&#39;, &#39;(9*x-3)/(5*x-1)&#39;]</span>
<span class="sd">      &gt;&gt;&gt; t = TableauFactory(test)</span>
<span class="sd">      &gt;&gt;&gt; t.export_pst(simplif = False, ext=&#39;pag&#39;)</span>
<span class="sd">      &gt;&gt;&gt; t.export_latex(simplif = True)</span>
<span class="sd">      &gt;&gt;&gt; for e in t: print(e.get_solutions(&#39;++&#39;))</span>
<span class="sd">      \\left] - \\frac{2}{3};+\\infty \\right[</span>
<span class="sd">      \\left] -\\infty;-4\\right[\\cup \\left] - \\frac{4}{5};+\\infty \\right[</span>
<span class="sd">      \\left] -\\infty;\\frac{1}{5}\\right[\\cup \\left] \\frac{1}{3};+\\infty \\right[</span>
<span class="sd">      &gt;&gt;&gt; t2 = TableauFactory([randExpr(3) for i in range(2)])</span>
<span class="sd">      &gt;&gt;&gt; for x in t2: print(latex(x.expr)+&#39;\\n&#39;+ x.tab2latex(simplif = True)+&#39;\\n&#39;)</span>
<span class="sd">      - \\frac{4 x + 1}{x \\left(- 3 x -2\\right)}</span>
<span class="sd">      $$\\tabvar{%</span>
<span class="sd">      \\tx{x} &amp; \\tx{-\\infty} &amp;  &amp; \\tx{- \\frac{2}{3}} &amp;  &amp; \\tx{- \\frac{1}{4}} &amp;  &amp; \\tx{0} &amp;  &amp; \\tx{+\\infty}\\cr</span>
<span class="sd">      \\tx{\\text{signe de }f} &amp;  &amp; \\tx{-} &amp; \\dbt &amp; \\tx{+} &amp; \\txt{0} &amp; \\tx{-} &amp; \\dbt &amp; \\tx{+} &amp; \\cr}$$</span>
<span class="sd">      </span>
<span class="sd">      3 \\frac{x}{\\left(x -3\\right) \\left(2 x -4\\right)}</span>
<span class="sd">      $$\\tabvar{%</span>
<span class="sd">      \\tx{x} &amp; \\tx{-\\infty} &amp;  &amp; \\tx{0} &amp;  &amp; \\tx{2} &amp;  &amp; \\tx{3} &amp;  &amp; \\tx{+\\infty}\\cr</span>
<span class="sd">      \\tx{\\text{signe de }f} &amp;  &amp; \\tx{-} &amp; \\txt{0} &amp; \\tx{+} &amp; \\dbt &amp; \\tx{-} &amp; \\dbt &amp; \\tx{+} &amp; \\cr}$$</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TableauSigne</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<div class="viewcode-block" id="TableauFactory.export_pst"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauFactory.export_pst">[docs]</a>    <span class="k">def</span> <span class="nf">export_pst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simplif</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="s">&quot;pag&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;créer les fichiers sortie au format pag/pst avec option </span>
<span class="sd">        de simplification (False par défaut)</span>

<span class="sd">        :param boolean simplif: simplifier les tableaux ou pas</span>
<span class="sd">        :param string ext: extension de la sortie pag (pdfadd) pst (pstplus)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">export_pst</span><span class="p">(</span><span class="n">nom</span><span class="o">=</span><span class="s">&quot;tableau&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">simplif</span> <span class="o">=</span> <span class="n">simplif</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TableauFactory.export_latex"><a class="viewcode-back" href="../interface.html#tabsigne3.TableauFactory.export_latex">[docs]</a>    <span class="k">def</span> <span class="nf">export_latex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="o">=</span><span class="s">&quot;tableaux_liste&quot;</span><span class="p">,</span> <span class="n">simplif</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="s">&quot;tex&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;créer la sortie latex des tableaux dans un seul fichier avec option</span>
<span class="sd">        de simplification.</span>

<span class="sd">        :param string nom: le nom de la sortie .tex</span>
<span class="sd">        :param boolean simplif: simplifier les tableaux ou pas</span>
<span class="sd">        :param string ext: extension de la sortie (pour compatibilite)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">nom</span><span class="o">+</span><span class="s">&quot;.&quot;</span><span class="o">+</span><span class="n">ext</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">t</span><span class="o">.</span><span class="n">tab2latex</span><span class="p">(</span><span class="n">simplif</span> <span class="o">=</span> <span class="n">simplif</span><span class="p">))</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="randExpr"><a class="viewcode-back" href="../interface.html#tabsigne3.randExpr">[docs]</a><span class="k">def</span> <span class="nf">randExpr</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">denomin</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;créer aléatoirement une expression avec n facteurs du 1er degré à coef</span>
<span class="sd">    entiers compris entre a et b. Le placement au numérateur/dénominateur se</span>
<span class="sd">    fait aussi au hasard.</span>

<span class="sd">    :param int n: le nombre de facteurs, 2 par défaut</span>
<span class="sd">    :param int a: borne inférieure des coefs, -5 par défaut</span>
<span class="sd">    :param int b: borne supérieure des coefs, 5 par défaut</span>
<span class="sd">    :param boolean denomin: autoriser des expressions au dénominateur, True par défaut</span>

<span class="sd">    exemple::</span>

<span class="sd">      &gt;&gt;&gt; randExpr(2)</span>
<span class="sd">      (-x + 2)/(2*x + 3)</span>
<span class="sd">      &gt;&gt;&gt; randExpr(3,-15,15)</span>
<span class="sd">      (-3*x + 2)*(14*x - 10)/(5*x - 14)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ope</span> <span class="o">=</span> <span class="p">([</span><span class="s">&#39;/&#39;</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">denomin</span> <span class="k">else</span> <span class="p">[</span><span class="s">&#39;*&#39;</span><span class="p">])</span>
    <span class="n">F</span> <span class="o">=</span> <span class="p">[(</span><span class="n">random_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">polys</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="n">choice</span><span class="p">(</span><span class="n">ope</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;)&#39;</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">))</span>
    <span class="c"># sadly certains facteurs &quot;colinéaires&quot; pourraient se neutraliser</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">n</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">degree</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">degree</span><span class="p">(</span><span class="n">Poly</span><span class="p">(</span><span class="n">denom</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="n">x</span><span class="p">))</span> <span class="o">!=</span><span class="n">n</span><span class="p">)):</span>
        <span class="n">F</span> <span class="o">=</span> <span class="p">[(</span><span class="n">random_poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">polys</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="n">choice</span><span class="p">(</span><span class="n">ope</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;)&#39;</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">out</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Index des modules Python"
             >modules</a> |</li>
        <li><a href="../index.html">documentation TableauSigne 0.9.3</a> &raquo;</li>
          <li><a href="index.html" >Code du module</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, B.M. - GPL v3.
      Créé avec <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>